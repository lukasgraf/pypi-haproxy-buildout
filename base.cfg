[buildout]
parts +=
    haproxy-build
    haproxy-conf

extends =
    versions.cfg
    supervisor.cfg


[haproxy-build]
recipe = plone.recipe.haproxy
url = http://dist.plone.org/thirdparty/haproxy-${versions:haproxy}.zip
target = generic
cpu = generic
pcre = 1


[haproxy-conf]
recipe = collective.recipe.template
input = ${buildout:directory}/haproxy.conf.in
output = ${buildout:directory}/parts/haproxy/etc/haproxy.conf
maxconn = 24000
user = zope
group = zope
bind = 0.0.0.0:80
bind-incoming = pypi.mydomain.com:80
bind-pypia = 0.0.0.0:8081
bind-pypic = 0.0.0.0:8083
bind-pypid = 0.0.0.0:8084
bind-pypie = 0.0.0.0:8085
bind-pypif = 0.0.0.0:8086
